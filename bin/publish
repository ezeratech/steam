#!/usr/bin/env ruby

require_relative '../lib/steam'

# bin/publish

class Publish

  def start # version, rvm=false
    # system "rvm use #{rvm}"

    system "bundle && bundle exec rspec"
    system "gem build locomotivecms_steam.gemspec"
    system "git tag -a v#{Locomotive::Steam::VERSION} -m 'version #{Locomotive::Steam::VERSION}'"
    system "git push --tags"
    system "gem push locomotivecms_steam-#{Locomotive::Steam::VERSION}.gem"
    system "git push origin master"
  end

end

# if ARGV.length != 1 # or !ARGV[0].match(/\d{1,3}.\d{1,3}.\d{1,3}/)
#   puts 'HELP: '
#   puts '$ bin/publish [ruby-2.1.1@steam]'
#   exit 0
# end

Publish.new.start # ARGV[0]